(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{X:()=>X});var t=document.querySelector("#card").content,n=document.querySelector(".elements-grid"),o=document.querySelector(".profile__name"),r=function(e){var t;e.target.classList.toggle("element__like_active"),e.target.classList.contains("element__like_active")?(t=e.target.closest(".element__item").id,fetch("".concat(m.baseUrl,"/cards/likes/")+t,{method:"PUT",headers:m.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){a(e._id,e.likes.length)})).catch((function(e){console.log("Ошибка: ".concat(e))}))):function(e){fetch("".concat(m.baseUrl,"/cards/likes/")+e,{method:"DELETE",headers:m.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){a(e._id,e.likes.length)})).catch((function(e){console.log("Ошибка: ".concat(e))}))}(e.target.closest(".element__item").id)},c=function(e){n.prepend(function(e){var n=t.querySelector(".element__item").cloneNode(!0);return n.querySelector(".element__photo").src=e.link,n.querySelector(".element__photo").alt=e.name,n.id=e._id,n.querySelector(".element__title").textContent=e.name,n.querySelector(".element__trash").addEventListener("click",U),n.querySelector(".element__like-numbers").textContent=e.likes.length,n.querySelector(".element__like").addEventListener("click",r),n.querySelector(".element__photo").addEventListener("click",P),n}(e))};function a(e,t){Array.from(document.querySelectorAll(".element__item")).forEach((function(n){n.id===e&&(n.querySelector(".element__like-numbers").textContent=t)}))}var u=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n.inactiveButtonClass),t.disabled=!1):(t.classList.add(n.inactiveButtonClass),t.disabled=!0)},i=document.querySelector(".popup__input_name"),l=document.querySelector(".popup__input_profession"),s=document.querySelector(".popup__input_avatar_link"),d=document.querySelector(".profile__name"),p=document.querySelector(".profile__profession"),_=document.querySelector(".profile__avatar"),m={baseUrl:"https://nomoreparties.co/v1/wbf-cohort-4",headers:{authorization:"f8b7451c-8abd-4722-9293-22498f2bcdfa","Content-Type":"application/json"}};function f(e){document.querySelector(".popup__button-save_profile").textContent=e?"Сохранение...":"Сохранить"}function v(e){document.querySelector(".popup__button-save_avatar").textContent=e?"Сохранение...":"Сохранить"}function y(e){document.querySelector(".popup__button-save_card").textContent=e?"Создание...":"Создать"}function h(e){document.querySelector(".popup__button-save_delete").textContent=e?"Удаление...":"Да"}fetch("".concat(m.baseUrl,"/users/me"),{method:"GET",headers:m.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){d.id=e._id,d.textContent=e.name,p.textContent=e.about,_.src=e.avatar,i.value=e.name,l.value=e.about,fetch("".concat(m.baseUrl,"/cards"),{headers:m.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){e.reverse().forEach((function(e){c(e),function(e){e.owner._id===o.id?(document.querySelector(".element__trash").disabled=!1,document.querySelector(".element__trash").classList.remove("element__trash_disabled")):(document.querySelector(".element__trash").disabled=!0,document.querySelector(".element__trash").classList.add("element__trash_disabled"))}(e),e.likes.forEach((function(e){!function(e){e===o.id&&document.querySelector(".element__like").classList.add("element__like_active")}(e._id)}))}))})).catch((function(e){console.log("Ошибка: ".concat(e))})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);u(n,o,t),n.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n){t.validity.valid?function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass),o.textContent=""}(e,t,n):function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add(o.inputErrorClass),r.classList.add(o.errorClass),r.textContent=n}(e,t,t.validationMessage,n)}(e,r,t),u(n,o,t)}))}))}(t,e)}))}(X)})).catch((function(e){console.log("Ошибка: ".concat(e))}));var S=document.querySelector(".popup__input_card_title"),q=document.querySelector(".popup__input_card_link"),b=document.querySelector(".popup_photo"),k=document.querySelector(".popup__image"),g=document.querySelector(".popup__caption"),L=document.querySelector(".profile__avatar"),E=document.querySelector(".popup__input_avatar_link"),C=document.querySelector(".popup_delete");function j(e){e.classList.add("popup_opened"),document.addEventListener("keydown",A)}function x(){document.querySelector(".popup_opened")&&(document.querySelector(".popup_opened").classList.remove("popup_opened"),document.removeEventListener("keydown",A),C.id="")}var P=function(e){k.src=e.target.src,k.alt=e.target.alt,g.textContent=e.target.alt,j(b)};function A(e){"Escape"===e.key&&x()}var U=function(e){var t=e.target.closest(".element__item");j(C),C.id=t.id},T=document.querySelector(".popups"),O=document.querySelector(".popup__form_name"),w=document.querySelector(".popup__form_card"),D=document.querySelector(".popup__form_delete"),B=document.querySelector(".popup__form_avatar"),N=document.querySelector(".profile__edit-button"),J=document.querySelector(".profile__add-button"),H=document.querySelector(".pofile__avatar-edit"),z=document.querySelector(".popup_profile"),G=document.querySelector(".popup_cards"),M=document.querySelector(".popup_avatar"),X={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button-save",inactiveButtonClass:"popup__button_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"};N.addEventListener("click",(function(){j(z)})),J.addEventListener("click",(function(){j(G),T.querySelector(".popup__button-save_card").classList.add("popup__button_inactive"),T.querySelector(".popup__button-save_card").disabled=!0})),H.addEventListener("click",(function(){j(M),T.querySelector(".popup__button-save_avatar").classList.add("popup__button_inactive"),T.querySelector(".popup__button-save_avatar").disabled=!0})),T.addEventListener("mousedown",(function(e){(e.target.closest(".popup__button-close")||e.target.classList.contains("popup"))&&x()})),w.addEventListener("submit",(function(e){var t;e.preventDefault(),t={name:"".concat(S.value),link:"".concat(q.value)},y(!0),fetch("".concat(m.baseUrl,"/cards"),{method:"POST",headers:m.headers,body:JSON.stringify({name:t.name,link:t.link})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){c(e)})).catch((function(e){console.log("Ошибка: ".concat(e))})).finally((function(){y(!1)})),e.target.reset(),x()})),O.addEventListener("submit",(function(e){e.preventDefault(),f(!0),fetch("".concat(m.baseUrl,"/users/me"),{method:"PATCH",headers:m.headers,body:JSON.stringify({name:i.value,about:l.value})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){d.id=e._id,d.textContent=e.name,p.textContent=e.about})).catch((function(e){console.log("Ошибка: ".concat(e))})).finally((function(){f(!1)})),x()})),B.addEventListener("submit",(function(e){e.preventDefault(),v(!0),fetch("".concat(m.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:m.headers,body:JSON.stringify({avatar:s.value})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){return console.log(e)})).catch((function(e){console.log("Ошибка: ".concat(e))})).finally((function(){v(!1)})),L.src=E.value,e.target.reset(),x()})),D.addEventListener("submit",(function(){Array.from(document.querySelectorAll(".element__item")).forEach((function(e){var t;e.id===C.id&&(t=e.id,h(!0),fetch("".concat(m.baseUrl,"/cards/")+t,{method:"DELETE",headers:m.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){return console.log(e)})).catch((function(e){console.log("Ошибка: ".concat(e))})).finally((function(){h(!1)})),e.remove())})),x()}))})();